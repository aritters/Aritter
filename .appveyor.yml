version: 1.1.{build}-{branch}
image: Visual Studio 2017
init:
- cmd: git config --global core.autocrlf true
build_script:
- cmd: dotnet build -c Release
test_script:
- cmd: dotnet test ./tests/Infra.Crosscutting.Tests/ -c Release
- cmd: dotnet test ./tests/Infra.Data.Seedwork.Tests/ -c Release
- cmd: dotnet test ./tests/Domain.Seedwork.Tests/ -c Release
artifacts:
- path: src\**\*.nupkg
  name: Nuget
before_deploy:
- cmd: dotnet pack ./src/Infra.Crosscutting/Infra.Crosscutting.csproj -c Release
- cmd: dotnet pack ./src/Infra.Data.Seedwork/Infra.Data.Seedwork.csproj -c Release
- cmd: dotnet pack ./src/Domain.Seedwork/Domain.Seedwork.csproj -c Release
- cmd: dotnet pack ./src/Application.Seedwork/Application.Seedwork.csproj -c Release
- cmd: dotnet pack ./src/Api.Seedwork/Api.Seedwork.csproj -c Release
deploy:
- provider: NuGet
  api_key:
    secure: RNo1ClS3IqGXKZQOx7AoUDSMFHj/erQgJrZuBGKR/A6k61aGNInSaB6fwG5rZchF
  skip_symbols: true
  on:
    branch: master